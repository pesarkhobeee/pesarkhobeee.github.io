+++
title = 'بایگانی خودکار ایمیل‌ها نخوانده شده جیمیل'
date = 2024-09-15T08:38:55+02:00
categories = ['life', 'hack']

tags = ['gmail', 'apps script']
+++



نمیدونم آیا شما هم مثل من در مدیریت صندوق پستی جیمیلتون ناموفق هستید یا نه، ولی من هر بار که از دست ایمیل های خوانده نشده و غیر مهم خلاص میشم و حتی چند روز بعدش رو مدام حواسم هست که باز هم inbox من پر از ایمیل های غیر مهم خوانده نشده نشن ولی نهایتا باز هم بعد از یه مدت به شکل سابق برمیگرده و من وسط کلی ایمیل خوانده نشده فقط موارد مهم رو باز و ستاره دار میکنم.

نهایتا تصمیم گرفتم روند آرشیو کردن ایمیل های نخوانده رو خودکار کنم و راه حل بنسبت ساده ای براش پیدا کردم:

### مراحل تعریف اسکریپت Google Apps برای بایگانی خودکار ایمیل‌ها

1. **باز کردن Google Apps Script**:
   - ابتدا وارد حساب کاربری Google خود شوید و به صفحه‌ی **[Google Drive](https://drive.google.com)** بروید.
   - روی گزینه‌ی **New (جدید)** کلیک کنید، سپس **Google Apps Script** را انتخاب کنید.

2. **ایجاد اسکریپت جدید**:
   - پس از باز شدن محیط Google Apps Script، کد پیش‌فرضی که نمایش داده می‌شود را حذف کنید.
   - کد زیر را جایگزین کنید:

   ```javascript
   function archiveOldEmails() {
     var oneWeekAgo = new Date(new Date().getTime() - 7 * 24 * 60 * 60 * 1000);
     var query = 'is:unread after:' + Utilities.formatDate(oneWeekAgo, "UTC", "yyyy/MM/dd"); // ایمیل های نخوانده شده قدیمی تر از یک هفته
     query += ' -is:starred in:inbox'; // حذف ایمیل‌های ستاره‌دار و بایگانی‌شده

     var threads = GmailApp.search(query);

     for (var i = 0; i < threads.length; i++) {
       var thread = threads[i];
       thread.moveToArchive(); // بایگانی کردن ایمیل
     }
   }
   ```

3. **ذخیره اسکریپت**:
   - پس از وارد کردن کد، روی گزینه‌ی **File > Save** (فایل > ذخیره) کلیک کنید.
   - برای اسکریپت خود یک نام انتخاب کنید، مثلا: `AutoArchiveEmails`.

4. **تنظیم اجرای خودکار اسکریپت**:
   - برای اجرای خودکار این اسکریپت به صورت روزانه یا هفتگی، باید یک **Trigger (ترتیب‌دهنده)** ایجاد کنید.
   - در Google Apps Script روی آیکون ساعت (Trigger) در بالای صفحه کلیک کنید.
   - روی **Add Trigger** (افزودن ترتیب‌دهنده) کلیک کنید.
   - گزینه‌ها را به این صورت تنظیم کنید:
     - **Function to run (تابع برای اجرا)**: `archiveOldEmails`
     - **Select event source (منبع رویداد)**: `Time-driven (زمانی)`
     - **Select type of time-based trigger (نوع ترتیب‌دهنده‌ی زمانی)**: `Day timer` یا `Week timer` (بسته به این‌که می‌خواهید روزانه یا هفتگی اجرا شود)

5. **پایان و اجرا**:
   - با ذخیره تنظیمات، اسکریپت به صورت خودکار در بازه زمانی تعیین‌شده اجرا می‌شود و ایمیل‌هایی که شرایط مشخص‌شده را دارند به‌طور خودکار بایگانی می‌شوند.

این اسکریپت به صورت خودکار ایمیل‌های نخوانده که ستاره‌دار یا مهم نیستند و در اینباکس باقی مانده‌اند را بایگانی می‌کند.